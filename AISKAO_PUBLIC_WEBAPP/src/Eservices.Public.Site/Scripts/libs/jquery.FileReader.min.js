(function(n){var t=n.Callbacks("once unique memory"),r=0,i=null,u;if(window.FileReader){n.fn.fileReader=function(){return this};return}n.fn.fileReader=function(i){i=n.extend(n.fn.fileReader.defaults,i);var r=this;return FileAPIProxy.ready||FileAPIProxy.init(i),t.add(function(){return u(r,i)}),n.isFunction(i.callback)&&t.add(i.callback),this},n.fn.fileReader.defaults={id:"fileReaderSWFObject",multiple:null,accept:null,label:null,extensions:null,filereader:"files/filereader.swf",expressInstall:null,debugMode:!1,callback:!1},u=function(t,u){return t.each(function(t,f){f=n(f);var e=f.attr("id");e||(e="flashFileInput"+r,f.attr("id",e),r++),u.multiple=!!(u.multiple===null?f.attr("multiple"):u.multiple),u.accept=u.accept===null?f.attr("accept"):u.accept,FileAPIProxy.inputs[e]=f,FileAPIProxy.swfObject.add(e,u.multiple,u.accept,u.label,u.extensions),f.css("z-index",0).mouseover(function(n){(f.offset().left!==FileAPIProxy.container.offset().left||f.offset().top!==FileAPIProxy.container.offset().top)&&(n=n||window.event,i=e,FileAPIProxy.swfObject.mouseover(e),FileAPIProxy.container.height(f.outerHeight()).width(f.outerWidth()).css(f.offset()))}).click(function(n){return n.preventDefault(),n.stopPropagation(),n.stopImmediatePropagation(),!1})})},window.FileAPIProxy={ready:!1,init:function(r){var u=this;u.ready=!1,u.swfObject=null,u.container=null,u.inputs={},u.readers={},this.debugMode=r.debugMode,this.container=n("<div>").attr("id",r.id).wrap("<div>").parent().css({position:"fixed",width:"1px",height:"1px",display:"inline-block",background:"transparent","z-index":99999}).on("mouseover mouseout mousedown mouseup",function(t){i&&n("#"+i).trigger(t.type)}).appendTo("body"),swfobject.embedSWF(r.filereader,r.id,"100%","100%","10",r.expressInstall,{debugMode:r.debugMode?!0:""},{wmode:"transparent",allowScriptAccess:"sameDomain"},{},function(i){u.swfObject=i.ref,n(u.swfObject).css({display:"block",outline:0}).attr("tabindex",0),u.ready&&t.fire(),u.ready=i.success&&typeof i.ref.add=="function"})},swfObject:null,container:null,inputs:{},readers:{},onFileInputEvent:function(n){if(this.debugMode&&console.info("FileInput Event ",n.type,n),n.target in this.inputs){var t=this.inputs[n.target];n.target=t[0],n.type==="change"&&(n.files=new FileList(n.files),n.target={files:n.files}),t.trigger(n)}window.focus()},onFileReaderEvent:function(n){if(this.debugMode&&console.info("FileReader Event ",n.type,n,n.target in this.readers),n.target in this.readers){var t=this.readers[n.target];n.target=t,t._handleFlashEvent.call(t,n)}},onFileReaderError:function(n){this.debugMode&&console.log(n)},onSWFReady:function(){return this.container.css({position:"absolute"}),this.ready=typeof this.swfObject.add=="function",this.ready&&t.fire(),!0}},window.FileReader=function(){this.EMPTY=0,this.LOADING=1,this.DONE=2,this.readyState=0,this.result=null,this.error=null,this.onloadstart=null,this.onprogress=null,this.onload=null,this.onabort=null,this.onerror=null,this.onloadend=null,this._callbacks={loadstart:n.Callbacks("unique"),progress:n.Callbacks("unique"),abort:n.Callbacks("unique"),error:n.Callbacks("unique"),load:n.Callbacks("unique"),loadend:n.Callbacks("unique")},this._id=null},window.FileReader.prototype={readAsBinaryString:function(n){this._start(n),FileAPIProxy.swfObject.read(n.input,n.name,"readAsBinaryString")},readAsText:function(n){this._start(n),FileAPIProxy.swfObject.read(n.input,n.name,"readAsText")},readAsDataURL:function(n){this._start(n),FileAPIProxy.swfObject.read(n.input,n.name,"readAsDataURL")},readAsArrayBuffer:function(){throw"Whoops FileReader.readAsArrayBuffer is unimplemented";},abort:function(){(this.result=null,this.readyState!==this.EMPTY&&this.readyState!==this.DONE)&&FileAPIProxy.swfObject.abort(this._id)},addEventListener:function(n,t){n in this._callbacks&&this._callbacks[n].add(t)},removeEventListener:function(n,t){n in this._callbacks&&this._callbacks[n].remove(t)},dispatchEvent:function(t){if(t.target=this,t.type in this._callbacks){var i=this["on"+t.type];n.isFunction(i)&&i(t),this._callbacks[t.type].fire(t)}return!0},_register:function(n){this._id=n.input+"."+n.name,FileAPIProxy.readers[this._id]=this},_start:function(n){if(this._register(n),this.readyState===this.LOADING)throw{type:"InvalidStateError",code:11,message:"The object is in an invalid state."};},_handleFlashEvent:function(n){switch(n.type){case"loadstart":this.readyState=this.LOADING;break;case"loadend":this.readyState=this.DONE;break;case"load":this.readyState=this.DONE,this.result=FileAPIProxy.swfObject.result(this._id);break;case"error":this.result=null,this.error={name:"NotReadableError",message:"The File cannot be read!"}}this.dispatchEvent(new FileReaderEvent(n))}},FileReaderEvent=function(n){this.initEvent(n)},FileReaderEvent.prototype={initEvent:function(t){n.extend(this,{type:null,target:null,currentTarget:null,eventPhase:2,bubbles:!1,cancelable:!1,defaultPrevented:!1,isTrusted:!1,timeStamp:(new Date).getTime()},t)},stopPropagation:function(){},stopImmediatePropagation:function(){},preventDefault:function(){}},FileList=function(n){if(n){for(var t=0;t<n.length;t++)this[t]=n[t];this.length=n.length}else this.length=0},FileList.prototype={item:function(n){return n in this?this[n]:null}}})(jQuery);
//@ sourceMappingURL=jquery.FileReader.min.js.map